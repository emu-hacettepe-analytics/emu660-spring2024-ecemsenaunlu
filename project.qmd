---
title: "Project Distribution of education levels by provinces and gender in Turkey over the years"

format:
  html:
    code-fold: true
    code-summary: "Show the code"
---

Welcome to my project page.

Keep an eye on this space to stay updated with my project activities.

![](images/analiz.gif){fig-align="center"}

# 1. Project Overview and Scope

In this study, the Completed education by province (15+ years old) data set made available by TUIK will be used. It contains data on gender distribution of education levels by province in Turkey between 2011 and 2021.

The population data set will be used to interpret the training data set meaningfully. This data set contains the numbers of women, men and total population in all cities in 2020.

With the 2020 Data set of Convicts Entered into Penal Institutions by Crime Type and Educational Level, crime situations in the provinces will be examined according to education levels in 2020.

With the Gross Domestic Product, 2020 data set, provinces' contribution volume data to the general Turkish domestic national product is kept. With this data set, it is aimed to associate the education data set with the contributions of the provinces to Turkey's gross national product.

# 2. Data

You can see education data below.

```{r}

suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

education <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/education.xls")

library(dslabs)
head(education)


```

You can see crime data set for 2020 below.

```{r}

suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

crime <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/crime.xls")

library(dslabs)
head(crime)


```
In exploratory data analysis, data sets were found insufficient for analysis and new data sets were added. Additional Datasets are provided below.

You can see population data set for 2020 below.

```{r}

suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

population <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/population.xls")

library(dslabs)
head(population)


```
You can see GSYMH data set for 2020 below.

```{r}

suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

GSYMH <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/GSYMH.xls")

library(dslabs)
head(GSYMH)


```
You can see GDP data set for 2020 below.

```{r}

suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

GDP <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/GDP.xls")

library(dslabs)
head(GDP)


```
You can see yearCrime data set below.

```{r}

suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

yearCrime <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/yearCrime.xls")

library(dslabs)
head(yearCrime)


```
[Also, click and reach .RData's File](https://github.com/emu-hacettepe-analytics/emu660-spring2024-ecemsenaunlu/tree/main/data)

## 2.1 Data Source

Completed education by province (15+ years old)

2020 Data set of Convicts Entered into Penal Institutions by Crime Type and Educational Level, crime situations in the province, Table 5

Address-Based Population Registration System Results, 2020, Table 3

Gross Domestic Product (GDP) 2018,2019,2020, Table 7

2020 Data set of Convicts Entered into Penal Institutions by Crime Type and Educational Level, crime situations in the province, Table 4

You can access following data sets from the link below:

[Reach Out To Data Source](https://data.tuik.gov.tr/Kategori/GetKategori?p=egitim-kultur-spor-ve-turizm-105&dil=1)


## 2.2 General Information About Data

Below you can find the names of all columns in the Education and Crime datasets and information about the data they represent.

Year : The Year where data is collected for statistical calculations.<br>

ProvinceID : The ProvinceID where data is collected for statistical calculations.

ProvinceName : The ProvinceName where data is collected for statistical calculations.

illiterateTotal : The illiterateTotal where Total number of illiterate people in Turkey.

illiterateMale : The IlliterateMale where Total number of illiterate men in Turkey.

illiterateFemale : The IlliterateFemale where Total number of illiterate women in Turkey.

LiterateWithoutADiplomaTotal :The LiterateWithoutADiplomaTotal is total number of people in Turkey which has no diploma.

LiterateWithoutADiplomaMale :The LiterateWithoutADiplomaTotal is total number of men in Turkey which has no diploma.

LiterateWithoutADiplomaFemale :The LiterateWithoutADiplomaTotal is total number of women in Turkey which has no diploma.

PrimarySchoolTotal : The PrimarySchoolTotal is number of people which graduated from Primary school in Turkey.

PrimarySchoolMale : The PrimarySchoolMale is number of men which graduated from Primary school in Turkey.

PrimarySchoolFemale : The PrimarySchoolMale is number of women which graduated from Primary school in Turkey.

PrimaryEducationTotal : The PrimaryEducationTotal is number of people which graduated from Primary Education in Turkey. <br>

PrimaryEducationMale : The PrimaryEducationMale is number of men which graduated from Primary Education in Turkey.

PrimaryEducationFemale : The PrimaryEducationFemale is number of women which graduated from Primary Education in Turkey.

LowerSecondarySchoolTotal : The LowerSecondarySchoolTotal is number of people which graduated from Lower Secondary School in Turkey.

LowerSecondarySchoolMale :The LowerSecondarySchoolMale is number of men which graduated from Lower Secondary School in Turkey.

LowerSecondarySchoolFemale :The LowerSecondarySchoolFemale is number of women which graduated from Lower Secondary School in Turkey.

UpperSecondarySchoolTotal :The UpperSecondarySchoolTotal is number of people which graduated from Upper Secondary School in Turkey.

UpperSecondarySchoolMale :The LowerSecondarySchoolMale is number of men which graduated from Upper Secondary School in Turkey.

UpperSecondarySchoolFemale :The LowerSecondarySchoolFemale is number of women which graduated from Upper Secondary School in Turkey.

HigherEducationalinstitutionsTotal :The HigherEducationalinstitutionsTotal is number of people which graduated from Higher Educational institutions in Turkey.

HigherEducationalinstitutionsMale :The HigherEducationalinstitutionsMale is number of men which graduated from Higher Educational institutions in Turkey.

HigherEducationalinstitutionsFemale :The HigherEducationalinstitutionsFemale is number of women which graduated from Higher Educational institutions in Turkey.

MasterTotal :The MasterTotal is number of people which graduated from Master in Turkey.

MasterMale : The MasterTotal is number of men which graduated from Master in Turkey.

MasterFemale : The MasterTotal is number of women which graduated from Master in Turkey.

DoctorateTotal : The DoctorateTotal is number of people which graduated from Master in Turkey.

DoctorateMale :The DoctorateTotal is number of men which graduated from Master in Turkey.

DoctorateFemale :The DoctorateTotal is number of women which graduated from Master in Turkey.

UnknownTotal : The UnknownTotal is the number of people whose educational status is unknown in Turkey.

UnknownMale :The UnknownTotal is the number of men whose educational status is unknown in Turkey.

UnknownFemale :The UnknownTotal is the number of women whose educational status is unknown in Turkey.


Below you can find the names of all columns in the Population dataset and information about the data they represent.

Provinces : The Provinces where data is collected for statistical calculations.

TotalPopulation : TotalPopulation data gives the total number of people living in that city.

TotalFemale : TotalPopulation data gives the total number of women living in that city.

TotalMale : TotalPopulation data gives the total number of men living in that city.


Below you can find the names of all columns in the GSYMH dataset and information about the data they represent.

ProvinceNames : The Provinces where data is collected for statistical calculations.

2018 : It is the contribution rate of cities to Turkey's Gross National Product in 2018.

2019 : It is the contribution rate of cities to Turkey's Gross National Product in 2019.

2020 : It is the contribution rate of cities to Turkey's Gross National Product in 2020.

Below you can find the names of all columns in the GDP dataset and information about the data they represent.

ProvinceNames : The Provinces where data is collected for statistical calculations.

2018 : It is the Gross National Product per capita in cities in Türkiye in 2018.

2019 : It is the Gross National Product per capita in cities in Türkiye in 2019.

2020 : It is the Gross National Product per capita in cities in Türkiye in 2020.

## 2.3 Reason of Choice

The change in education level by province in Turkey over the years is an interesting data set. Comments can be made on how the relevant data has changed and developed over the years. For this reason, the changes in Turkey's literacy rates and postgraduate education rates according to provinces and years will be examined in detail.

Additionally, a second data set will be used to examine the relationship between education levels and crime rates. This data set provides us with crimes and crime rates according to education levels in 2020. In addition, it is seen that the 2020 population numbers of the provinces are an important data source for the correct evaluation of the relevant data. 

In the yearCrime data set, data on crime rates according to years and education levels is presented. It is aimed to perform time series analysis using relevant data.

In addition, another data set showing the contribution of provinces to Turkey's gross national product will also be used. I estimate that there is a linear relationship between these data and graduate education rates in cities. A regression analysis will be conducted in this direction.

# 2.4 Data Preprocessing

Data preprocessing was carried out to edit the Turkish characters in the Turkey data set that we will use on the map, and the uses of K. Maras and KahramanMaras, which are not common with other data sets.

```{r}

library(ggrepel)
library(sf)
library(dplyr)
library(ggplot2)
library(sf)
library(dplyr)
library(rnaturalearth)
library(rnaturalearthdata)
library(devtools)

devtools::install_github("ropensci/rnaturalearthhires")

turkey <- ne_states(country = "Turkey", returnclass = "sf")
head(turkey$`name`)
turkey$name <- iconv(turkey$name, "UTF-8", "ASCII//TRANSLIT")
turkey$name <- gsub("Igdir", "igdir", turkey$name, fixed = TRUE)
turkey$name <- gsub("Zinguldak", "Zonguldak", turkey$name, fixed = TRUE)
turkey$name <- gsub("Kinkkale", "Kirikkale", turkey$name, fixed = TRUE)
turkey$name <- gsub("Sirnak", "sirnak", turkey$name, fixed = TRUE)
turkey$name <- gsub("Sanliurfa", "sanliurfa", turkey$name, fixed = TRUE)
turkey$name <- gsub("K. Maras", "Kahramanmaras", turkey$name, fixed = TRUE)
turkey$name <- gsub("Afyonkarahisar", "Afyon", turkey$name, fixed = TRUE)
turkey$name <- gsub("Canakkale", "canakkale", turkey$name, fixed = TRUE)
turkey$name <- gsub("Cankiri", "cankiri", turkey$name, fixed = TRUE)
turkey$ProvinceNames <- turkey$name
turkeyChanged <- turkey
```
# 3. Analysis

We will have many summary data thanks to the data set that will enable us to analyze education levels in Turkey. And we will observe the relationships between them and crime data.

## 3.1 Exploratory Data Analysis

Below you see the graph of the total number of illiterate people in Turkey according to years. From the graph, it can be observed that the number of illiterate people in Turkey has decreased over the years. Stay tuned for many more summary data like this and analysis of the relationships between data.

```{r}
suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

education <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/education.xls")


education2 <- education %>%
  group_by(Year) %>%
  summarise(illiterateYearTotal = sum(illiterateTotal))


education2 %>%
  ggplot(aes(x = Year, y = illiterateYearTotal)) +
  geom_bar(stat = "identity", fill = "purple") +
  labs(title = "Distribution of Illiterate Total Per Year",
       x = "Year",
       y = "Illiterate Total") +
 theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
       axis.text.y = element_text(size = 8))

```

```{r}
suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(ggplot2)

crime <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/crime.xls")

crime <- crime %>% mutate(CRilliterateTotal = CRilliterateMale + CRilliterateFemale)
crime2 <- crime %>%
  group_by(CRilliterateTotal)


crime2 %>%
  ggplot(aes(x = `Type of crime`, y = CRilliterateTotal)) +
  geom_bar(stat = "identity", fill = "green") +
  labs(title = "Distribution of Illiterate Total Per Type Of Crime",
       x = "Type of crime",
       y = "Illiterate Total") +
 theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
       axis.text.y = element_text(size = 8))

```

## 3.2 Trend Analysis

First of all, how many doctoral and master's students were in each city in 2020, these statistics will be discussed.

```{r}
suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)

education <- read_excel("C:/Users/w10/Documents/GitHub/emu660-spring2024-ecemsenaunlu/data/education.xls")


education2020 <- education %>% filter(Year == 2020)

education2020 %>%
  ggplot(aes(x = ProvinceName, y = DoctorateTotal)) +
  geom_bar(stat = "identity", fill = "purple") +
  labs(title = "Distribution of Doctorate Total per Province in 2020",
       x = "Province",
       y = "Doctorate Total") +
 theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
       axis.text.y = element_text(size = 8))

```

## 3.3 Model Fitting

First of all, in Exploratory Data Analysis, it is seen that the training data alone is insufficient to explain the data. For this reason, it was decided to benefit from the population data of 2020. The data on the proportion of people with doctorate and master's degrees in which city are located compared to the population will be examined.

```{r}

library(dplyr)
result <- inner_join(education2020, population, by = "ProvinceName")

DoctorateResult <- result %>%
  mutate(DoctoratePercentage = DoctorateTotal / TotalPopulation * 100 )

Doctorate <- DoctorateResult %>%
  ggplot() +
  geom_bar(aes(x = ProvinceName, y = DoctoratePercentage), 
           stat = "identity", fill = "blue", position = "dodge") + 
  labs(title = "Distribution of Doctorate Total per Total Population by Province in 2020",
       x = "Province",
       y = "Percentage") +
  theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
        axis.text.y = element_text(size = 8))


result <- inner_join(education2020, population, by = "ProvinceName")

MasterResult <- result %>%
  mutate(MasterPercentage = MasterTotal / TotalPopulation * 100)

Master <- MasterResult %>%
  ggplot() +
  geom_bar(aes(x = ProvinceName, y = MasterPercentage), 
           stat = "identity", fill = "purple", position = "dodge") + 
  labs(title = "Distribution of Master Total per Total Population by Province in 2020",
       x = "Province",
       y = "Percentage") +
  theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
        axis.text.y = element_text(size = 8))

library(gridExtra)

grid.arrange(Doctorate, Master, nrow = 2)
```

We see that Ankara is the province with the highest percentage of people with doctorate and master's degrees in 2020. It seems that the cities in the top 10 list with a high percentage of both master's and doctorate degrees are Ankara, Isparta, Eskişehir, Edirne, Canakkale, Izmir and Istanbul. At the same time, we aim to filter the provinces with the highest number of illiterate people and see if they can be associated with the general structure of the provinces.

```{r}

library(ggplot2)
library(dplyr)
library(gridExtra)

top_master <- MasterResult %>%
  arrange(desc(MasterPercentage)) %>%
  head(10)

top_doctorate <- DoctorateResult %>%
  arrange(desc(DoctoratePercentage)) %>%
  head(10)

topMaster <- ggplot(top_master) +
  geom_bar(aes(x = reorder(ProvinceName, -MasterPercentage), y = MasterPercentage), 
           stat = "identity", fill = "purple", position = "dodge") + 
  labs(title = "Distribution of the provinces with the highest percentage of master's degrees in 2020",
       x = "Province",
       y = "Percentage") +
  theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
        axis.text.y = element_text(size = 8))

topDoctorate <- ggplot(top_doctorate) +
  geom_bar(aes(x = reorder(ProvinceName, -DoctoratePercentage), y = DoctoratePercentage), 
           stat = "identity", fill = "pink", position = "dodge") + 
  labs(title = "Distribution of the provinces with the highest percentage of Doctorate's degrees in 2020",
       x = "Province",
       y = "Percentage") +
  theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
        axis.text.y = element_text(size = 8))


result <- inner_join(education2020, population, by = "ProvinceName")

IlliterateResult <- result %>%
  mutate(IlliteratePercentage = illiterateTotal / TotalPopulation * 100 )

top_illiterate <- IlliterateResult %>%
  arrange(desc(IlliteratePercentage)) %>%
  head(10)


topIlliterate <- ggplot(top_illiterate) +
  geom_bar(aes(x = reorder(ProvinceName, -IlliteratePercentage), y = IlliteratePercentage), 
           stat = "identity", fill = "blue", position = "dodge") + 
  labs(title = "Distribution of the provinces with the highest percentage of Illiterate people in Turkey in 2020",
       x = "Province",
       y = "Percentage") +
  theme(axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5, hjust = 1),
        axis.text.y = element_text(size = 8))
grid.arrange(topMaster, topDoctorate,topIlliterate, nrow = 3)
```
It is observed that the cities where people with doctorates and master's degrees are concentrated are different from the cities where illiterate people are concentrated.In this context, it can be associated with different data sets and other analyzes can be made.

Based on the above analysis results, analyzes will continue to be made with the prediction that it can be associated with a data set related to Turkey's development level. In this context, the contribution data of the provinces to Türkiye's gross national product will be used. Below, Turkey's contribution rates to the gross national product by province for 2020 are examined. As can be seen, Ankara is among the provinces with the highest contribution. Ankara was also one of the provinces with the highest rates of doctoral and master's degree holders. Based on this data, it comes to mind to examine whether there is a relationship between the high contribution to the gross national product in the provinces with high rates of doctoral and master's degree holders.

```{r}
library(ggrepel)
library(sf)
library(dplyr)
library(ggplot2)
library(sf)
library(dplyr)
library(rnaturalearth)
library(rnaturalearthdata)
library(devtools)

devtools::install_github("ropensci/rnaturalearthhires")

GSYMH2020 <- GSYMH %>% select(ProvinceNames, `2020`)


turkeyChanged <- turkeyChanged[complete.cases(turkeyChanged$featurecla),]
turkeyGSYMH <- inner_join(turkeyChanged, GSYMH2020, by = c("name" = "ProvinceNames"))

ggplot(turkeyGSYMH) +
  geom_sf(aes(fill = `2020`), color = "black") +
  geom_sf_text(aes(label = ProvinceNames), size = 1.5, color = "black") +  
  scale_fill_continuous(low = "white", high = "blue", name = "GSYMH2020") +
  theme_minimal() +
  labs(title = "Turkey's Provinces by GSYMH2020",
       subtitle = "GSYMH2020 values for illustration purposes",
       caption = "Source: Generated data") +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank())

top_GSYMH <- GSYMH2020 %>%
  arrange(desc('2020')) %>%
  head(10)
```
In this context, we will get support from correlation to examine the relationship between these two situations.
```{r}

correlationTest <- cor.test(top_doctorate$DoctoratePercentage, top_GSYMH$`2020`)


print(correlationTest)

correlation_plot <- ggplot(data = NULL, aes(x = top_doctorate$DoctoratePercentage, y = top_GSYMH$`2020`)) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Correlation Doctorate Percentage and GSYMH 2020",
       x = " Doctorate Percentage",
       y = "GSYMH 2020") +
  theme_minimal()

print(correlation_plot)

```
The correlation coefficient took the value of -0.319, which indicates a weak negative relationship between the two variables.
The p-value is 0.3688. indicates that this correlation is not statistically significant
As a result, although there appears to be a weak negative correlation between the variables DoctoratePercentage and 2020, this correlation is not statistically significant. Therefore, it cannot be concluded that there is a significant relationship between these two variables.


The ranking of the provinces that contribute the most to Turkey's Gross National Product is given below.
```{r}
top_GSYMH2020 <- turkeyGSYMH %>%
  arrange(desc(`2020`))

top_GSYMH2020 <- top_GSYMH2020 %>%
  select(`ProvinceNames`, `2020`)
print(top_GSYMH2020)
```
As can be seen, Ankara ranks first with the highest GDP contribution. The city with the highest number of people with postgraduate education was Ankara. In this context, the contribution of the high number of people who have completed postgraduate education to the Gross National Product will be investigated.

#3.3.2. Regression Analysis

```{r}
GSYMH2020$ProvinceName <- GSYMH2020$ProvinceNames
regressionData <- full_join(GSYMH2020, DoctorateResult, by = "ProvinceName")

model <- lm(`2020`~ DoctoratePercentage, data = regressionData)

summary(model)

plot(regressionData$DoctoratePercentage, regressionData$`2020`,
     main = "The relationship between the GDP percentage of provinces and the rate of people with a doctorate in 2020",
     xlab ="Doctorate Percentage" , ylab = "GDP Percentage", pch = 19, col = "blue")
abline(model, col = "red")

par(mfrow = c(2, 2))
plot(model)

residuals <- resid(model)
residuals_squared <- residuals^2
sum_squared_residuals <- sum(residuals_squared)
n <- length(residuals)

mean_residual_variance <- sum_squared_residuals / n
print(paste("Modelin hata terimlerinin varyansı:", mean_residual_variance))
```
The variance of the error terms turned out to be 0.015, and since the p value is less than 0.05, it can be interpreted that it does not have a constant variance. It took the value of p = 0.06927 and is not significant. The F-statistic is 3.395 and the p-value is 0.06927 This is used to evaluate whether the model is statistically significant in explaining the dependent variable. Since the p-value here is greater than 0.05, it cannot be said that the model is statistically significant. The R-squared value of the model is 0.03017 A low R-squared value indicates that the model does not have sufficient power to explain it.


The analysis here examines whether the gross national product data per capita in 2020 by provinces in Turkey has a relationship with the rates of doctoral graduates in the provinces in the same year.

```{r}
library(dplyr)

GDP2020 <- GDP %>% select(ProvinceNames, `2020`)
GDP2020$ProvinceName <- GDP2020$ProvinceNames
regressionData2 <- full_join(GDP2020, DoctorateResult, by = c("ProvinceName"))

model <- lm(`2020`~ DoctoratePercentage, data = regressionData2)

summary(model)

plot(regressionData$DoctoratePercentage, regressionData$`2020`,
     main = "The relationship between the GDP per person of provinces and the rate of people with a doctorate in 2020",
     xlab ="Doctorate Percentage" , ylab = "GDP Percentage", pch = 19, col = "blue")
abline(model, col = "red")

par(mfrow = c(2, 2))
plot(model)

residuals <- resid(model)
residuals_squared <- residuals^2
sum_squared_residuals <- sum(residuals_squared)
n <- length(residuals)

mean_residual_variance <- sum_squared_residuals / n
print(paste("Modelin hata terimlerinin varyansı:", mean_residual_variance))
```

The p-value is quite low (4.078e-06), indicating that the model is significant.Multiple R-squared value is 0.2451. This indicates that the model explains approximately 24.51% of the variance between the independent variables and the dependent variable.The variable DoctoratePercentage is 74056 and indicates how much the mean of the dependent variable will change as the DoctoratePercentage variable increases by one unit. The p-value is quite low (4.08e-06), which indicates that the model is highly significant.



# 3.3.3. Time Series

The relationship between people with postgraduate degrees and the number of crimes committed in Turkey between 2016 and 2020 will be examined.
```{r}
educationTotal <- education %>%
  group_by(Year) %>%
  summarise(illiterateYearTotal = sum(illiterateTotal), LiterateWithoutADiplomaTotal =sum(LiterateWithoutADiplomaTotal),PrimarySchoolTotal =sum(PrimarySchoolTotal), PrimaryEducationTotal =sum(PrimaryEducationTotal),UpperSecondarySchoolTotal=sum(UpperSecondarySchoolTotal), HigherEducationalinstitutionsTotal=sum(HigherEducationalinstitutionsTotal), HigherEducationTotal = sum(MasterTotal + DoctorateTotal), UnknownTotal=sum(UnknownTotal))

merged_data <- merge(educationTotal, yearCrime, by = "Year")
merged_data <- merged_data %>% mutate(IlliterateRate = IlliterateTotal / illiterateYearTotal)
merged_data <- merged_data %>% mutate(LiterateWithoutADiplomaRate = LiterateWithoutADiplomaTotal.x / LiterateWithoutADiplomaTotal.y)
merged_data <- merged_data %>% mutate(PrimarySchoolRate = PrimarySchoolTotal.x / PrimarySchoolTotal.y)
merged_data <- merged_data %>%
  mutate(PrimaryEducationRate = PrimaryEducationTotal.x / PrimaryEducationTotal.y)
merged_data <- merged_data %>%
  mutate(UpperSecondaryRate = UpperSecondaryTotal / UpperSecondarySchoolTotal )
merged_data <- merged_data %>%
  mutate(HigherEducationalinstitutionsRate = HigherEducationalinstitutionsTotal.x / HigherEducationalinstitutionsTotal.y)
merged_data <- merged_data %>%
  mutate(HigherEducationRate = HigherEducationTotal.x / HigherEducationTotal.y)
merged_data <- merged_data %>%
  mutate(UnknownRate = UnknownTotal.x / UnknownTotal.y)

grafik <- ggplot(merged_data, aes(x = Year)) +
  geom_line(aes(y = IlliterateRate, color = "Illiterate Rate")) +
  geom_line(aes(y = LiterateWithoutADiplomaRate, color = "Literate Without A Diploma Rate")) +
  geom_line(aes(y = PrimarySchoolRate, color = "Primary School Rate")) +
  geom_line(aes(y = PrimaryEducationRate, color = "Primary Education Rate")) +
  geom_line(aes(y = UpperSecondaryRate, color = "Upper Secondary Rate")) +
  geom_line(aes(y = HigherEducationalinstitutionsRate, color = "Higher Educational Institutions Rate")) +
  geom_line(aes(y = HigherEducationRate, color = "Higher Education Rate")) +
  geom_line(aes(y = UnknownRate, color = "Unknown Rate")) +
  labs(title = "Change in Crime Rate over Years by Education Types",
       x = "Yıl",
       y = "Oran",
       color = "Crime Rate ") +
  theme_minimal() +
  scale_color_manual(values = c("red", "blue", "green", "orange", "purple", "brown", "black","pink"))

print(grafik)

korelasyon_testi <- cor.test(merged_data$HigherEducationTotal.x, merged_data$HigherEducationTotal.y)

print(korelasyon_testi)
```

The correlation coefficient was estimated to be 0.915. This value indicates a strong positive relationship between the two variables. That is, these two variables tend to increase together.P value is a value that determines whether the correlation is statistically significant or not. Here, the p-value is 0.02917, which indicates that the correlation is statistically significant.

As a result, it can be said that there is a strong positive correlation between the two variables and this correlation is statistically significant.

A time series study was conducted based on the crime rates of people receiving postgraduate education according to years and education levels between 2016 and 2020.


```{r}

library(readxl)
library(forecast)
library(tseries)
library(ggplot2)

suppressPackageStartupMessages(library(dplyr))
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)


educationTotal <- education %>%
  group_by(Year) %>%
  summarise(illiterateYearTotal = sum(illiterateTotal), LiterateWithoutADiplomaTotal =sum(LiterateWithoutADiplomaTotal),PrimarySchoolTotal =sum(PrimarySchoolTotal), PrimaryEducationTotal =sum(PrimaryEducationTotal),UpperSecondarySchoolTotal=sum(UpperSecondarySchoolTotal), HigherEducationalinstitutionsTotal=sum(HigherEducationalinstitutionsTotal), HigherEducationTotal = sum(MasterTotal + DoctorateTotal), UnknownTotal=sum(UnknownTotal))
merged_data <- merge(educationTotal, yearCrime, by = "Year")
merged_data <- merged_data %>% mutate(IlliterateRate = IlliterateTotal / illiterateYearTotal)
merged_data <- merged_data %>%
  mutate(LiterateWithoutADiplomaRate = LiterateWithoutADiplomaTotal.x / LiterateWithoutADiplomaTotal.y)
merged_data <- merged_data %>%
  mutate(PrimarySchoolRate = PrimarySchoolTotal.x / PrimarySchoolTotal.y)
merged_data <- merged_data %>%
  mutate(PrimaryEducationRate = PrimaryEducationTotal.x / PrimaryEducationTotal.y)
merged_data <- merged_data %>%
  mutate(UpperSecondaryRate = UpperSecondaryTotal / UpperSecondarySchoolTotal )
merged_data <- merged_data %>%
  mutate(HigherEducationalinstitutionsRate = HigherEducationalinstitutionsTotal.x / HigherEducationalinstitutionsTotal.y)
merged_data <- merged_data %>%
  mutate(HigherEducationRate = HigherEducationTotal.x / HigherEducationTotal.y)
merged_data <- merged_data %>%
  mutate(UnknownRate = UnknownTotal.x / UnknownTotal.y)


timeSeriesData <- ts(merged_data$HigherEducationRate, start=min(merged_data$Year), end=max(merged_data$Year), frequency=1)

plot(timeSeriesData, main="Crime Rate with Higher Education People Time Series", ylab="Higher Education Rate", xlab="Year")

autoplot(timeSeriesData) + 
  ggtitle("Crime Rate with Higher Education People Time Series") + 
  ylab("Higher Education Rate") + 
  xlab("Year")


  print(timeSeriesData)
adf_test <- adf.test(timeSeriesData)
print(adf_test)

acf(timeSeriesData, main="ACF of Higher Education Rate")
pacf(timeSeriesData, main="PACF of Higher Education Rate")

best_arima_model <- auto.arima(timeSeriesData)
summary(best_arima_model)

forecast_model <- forecast(best_arima_model, h=5)
autoplot(forecast_model) + 
  ggtitle("Forecast of Higher Education Rate") + 
  ylab("Higher Education Rate") + 
  xlab("Year")
```
The fact that sigma^2 = 6.651e-06 shows that the variance of the residuals is quite low. This indicates that the error terms of the model are small. The log likelihood value is 18.17. This value shows how well the model fits the data. If it is positive, it indicates that the model fits the data quite well. MASE (Mean Absolute Scaled Error) value was 0.8009155. Less than 1 indicates that the model performs well. Looking at the various statistical measures of this model:
A low sigma^2 value indicates that model errors are low. Negative AIC, AICc and BIC values indicate that the model fits the data quite well. ME, RMSE, MAE, MPE, MAPE, MASE values are low and at an appropriate level. The ACF1 value shows that the residuals are independent and do not contain autocorrelation. As a result, we can say that the ARIMA(0,1,0) model is a suitable model for time series. Errors are low and the model has a good fit to the data.



## 3.4 Results

As a result 

# 4. Results and Key Takeaways

xxxxxx

